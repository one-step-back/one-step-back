import{j as e}from"../util/alert.min.js";import{S as n}from"../util/toast.min.js";import{C as b}from"../util/confirm.min.js";e(()=>{const r=e("#following-grid"),i=e("#loading-spinner"),c=e("#empty-state"),d=e("#sort-select");m(d.val()),d.on("change",function(){m(e(this).val())});function m(t){i.show(),r.hide(),c.hide(),e.ajax({url:"/api/v1/follows/list",type:"GET",data:{sort:t},success:o=>{const s=o.data||[];f(s)},error:o=>{console.error("[Error] 팔로우 목록 조회 실패:",o),n.error("목록을 불러오는데 실패했습니다.")},complete:()=>{i.hide()}})}function f(t){if(r.empty(),!t||t.length===0){c.fadeIn();return}let o="";t.forEach(s=>{o+=`
                <div class="artist-card" id="card-${s.id}">
                    <div class="artist-avatar" 
                         style="background-image: url('${s.artistProfilePath}');">
                    </div>
                    
                    <div class="artist-info">
                        <span class="artist-blog-name" title="${s.blogName}">${s.blogName}</span>
                        <span class="artist-nickname">@${s.artistNickname}</span>
                    </div>
                    
                    <div class="card-actions">
                        <a href="/artist/${s.id}" class="btn-visit">방문</a>
                        <button type="button" class="btn-toggle-follow btn-unfollow" 
                                data-id="${s.id}" 
                                data-name="${s.artistNickname}"
                                data-status="true">
                            취소
                        </button>
                    </div>
                </div>
            `}),r.html(o).fadeIn()}e(document).on("click",".btn-toggle-follow",function(){const t=e(this),o=t.data("id"),s=t.data("name"),l=t.data("status"),u=()=>{const p=l?"DELETE":"POST";t.prop("disabled",!0),e.ajax({url:`/api/v1/follows/${o}`,type:p,success:()=>{const a=!l;t.data("status",a),a?(t.removeClass("btn-follow").addClass("btn-unfollow"),t.text("취소"),n.success("다시 팔로우했습니다.")):(t.removeClass("btn-unfollow").addClass("btn-follow"),t.text("팔로우"),n.info("팔로우를 취소했습니다.")),e(document).trigger("artist:nav-update")},error:a=>{const g=a.responseJSON?.error?.message||"요청 처리에 실패했습니다.";n.error(g)},complete:()=>{t.prop("disabled",!1)}})};l?b.open({title:"팔로우 취소",desc:`'${s}'님을 팔로우 취소하시겠습니까?`,actionText:"취소하기",onConfirm:u}):u()})});
