import{j as L}from"./util/alert.min.js";import{c as _,a as Sr,g as Pr}from"../_commonjsHelpers.min.js";var ne={exports:{}},Q={},ut;function Ur(){return ut||(ut=1,_.crypto&&_.crypto.getRandomValues?Q.randomBytes=function(u){var e=new Uint8Array(u);return _.crypto.getRandomValues(e),e}:Q.randomBytes=function(u){for(var e=new Array(u),i=0;i<u;i++)e[i]=Math.floor(Math.random()*256);return e}),Q}var ie,ct;function F(){if(ct)return ie;ct=1;var u=Ur(),e="abcdefghijklmnopqrstuvwxyz012345";return ie={string:function(i){for(var o=e.length,r=u.randomBytes(i),c=[],s=0;s<i;s++)c.push(e.substr(r[s]%o,1));return c.join("")},number:function(i){return Math.floor(Math.random()*i)},numberString:function(i){var o=(""+(i-1)).length,r=new Array(o+1).join("0");return(r+this.number(i)).slice(-o)}},ie}var lt;function D(){return lt||(lt=1,(function(u){var e=F(),i={},o=!1,r=_.chrome&&_.chrome.app&&_.chrome.app.runtime;u.exports={attachEvent:function(s,f){typeof _.addEventListener<"u"?_.addEventListener(s,f,!1):_.document&&_.attachEvent&&(_.document.attachEvent("on"+s,f),_.attachEvent("on"+s,f))},detachEvent:function(s,f){typeof _.addEventListener<"u"?_.removeEventListener(s,f,!1):_.document&&_.detachEvent&&(_.document.detachEvent("on"+s,f),_.detachEvent("on"+s,f))},unloadAdd:function(s){if(r)return null;var f=e.string(8);return i[f]=s,o&&setTimeout(this.triggerUnloadCallbacks,0),f},unloadDel:function(s){s in i&&delete i[s]},triggerUnloadCallbacks:function(){for(var s in i)i[s](),delete i[s]}};var c=function(){o||(o=!0,u.exports.triggerUnloadCallbacks())};r||u.exports.attachEvent("unload",c)})(ne)),ne.exports}var oe,ft;function $r(){return ft||(ft=1,oe=function(e,i){if(i=i.split(":")[0],e=+e,!e)return!1;switch(i){case"http":case"ws":return e!==80;case"https":case"wss":return e!==443;case"ftp":return e!==21;case"gopher":return e!==70;case"file":return!1}return e!==0}),oe}var K={},ht;function Br(){if(ht)return K;ht=1;var u=Object.prototype.hasOwnProperty,e;function i(s){try{return decodeURIComponent(s.replace(/\+/g," "))}catch{return null}}function o(s){try{return encodeURIComponent(s)}catch{return null}}function r(s){for(var f=/([^=?#&]+)=?([^&]*)/g,l={},n;n=f.exec(s);){var t=i(n[1]),a=i(n[2]);t===null||a===null||t in l||(l[t]=a)}return l}function c(s,f){f=f||"";var l=[],n,t;typeof f!="string"&&(f="?");for(t in s)if(u.call(s,t)){if(n=s[t],!n&&(n===null||n===e||isNaN(n))&&(n=""),t=o(t),n=o(n),t===null||n===null)continue;l.push(t+"="+n)}return l.length?f+l.join("&"):""}return K.stringify=c,K.parse=r,K}var se,dt;function xr(){if(dt)return se;dt=1;var u=$r(),e=Br(),i=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,o=/[\n\r\t]/g,r=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,c=/:\d+$/,s=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,f=/^[a-zA-Z]:/;function l(v){return(v||"").toString().replace(i,"")}var n=[["#","hash"],["?","query"],function(g,d){return h(d.protocol)?g.replace(/\\/g,"/"):g},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],t={hash:1,query:1};function a(v){var g;typeof window<"u"?g=window:typeof _<"u"?g=_:typeof self<"u"?g=self:g={};var d=g.location||{};v=v||d;var m={},x=typeof v,y;if(v.protocol==="blob:")m=new O(unescape(v.pathname),{});else if(x==="string"){m=new O(v,{});for(y in t)delete m[y]}else if(x==="object"){for(y in v)y in t||(m[y]=v[y]);m.slashes===void 0&&(m.slashes=r.test(v.href))}return m}function h(v){return v==="file:"||v==="ftp:"||v==="http:"||v==="https:"||v==="ws:"||v==="wss:"}function b(v,g){v=l(v),v=v.replace(o,""),g=g||{};var d=s.exec(v),m=d[1]?d[1].toLowerCase():"",x=!!d[2],y=!!d[3],p=0,w;return x?y?(w=d[2]+d[3]+d[4],p=d[2].length+d[3].length):(w=d[2]+d[4],p=d[2].length):y?(w=d[3]+d[4],p=d[3].length):w=d[4],m==="file:"?p>=2&&(w=w.slice(2)):h(m)?w=d[4]:m?x&&(w=w.slice(2)):p>=2&&h(g.protocol)&&(w=d[4]),{protocol:m,slashes:x||h(m),slashesCount:p,rest:w}}function C(v,g){if(v==="")return g;for(var d=(g||"/").split("/").slice(0,-1).concat(v.split("/")),m=d.length,x=d[m-1],y=!1,p=0;m--;)d[m]==="."?d.splice(m,1):d[m]===".."?(d.splice(m,1),p++):p&&(m===0&&(y=!0),d.splice(m,1),p--);return y&&d.unshift(""),(x==="."||x==="..")&&d.push(""),d.join("/")}function O(v,g,d){if(v=l(v),v=v.replace(o,""),!(this instanceof O))return new O(v,g,d);var m,x,y,p,w,I,N=n.slice(),j=typeof g,E=this,S=0;for(j!=="object"&&j!=="string"&&(d=g,g=null),d&&typeof d!="function"&&(d=e.parse),g=a(g),x=b(v||"",g),m=!x.protocol&&!x.slashes,E.slashes=x.slashes||m&&g.slashes,E.protocol=x.protocol||g.protocol||"",v=x.rest,(x.protocol==="file:"&&(x.slashesCount!==2||f.test(v))||!x.slashes&&(x.protocol||x.slashesCount<2||!h(E.protocol)))&&(N[3]=[/(.*)/,"pathname"]);S<N.length;S++){if(p=N[S],typeof p=="function"){v=p(v,E);continue}y=p[0],I=p[1],y!==y?E[I]=v:typeof y=="string"?(w=y==="@"?v.lastIndexOf(y):v.indexOf(y),~w&&(typeof p[2]=="number"?(E[I]=v.slice(0,w),v=v.slice(w+p[2])):(E[I]=v.slice(w),v=v.slice(0,w)))):(w=y.exec(v))&&(E[I]=w[1],v=v.slice(0,w.index)),E[I]=E[I]||m&&p[3]&&g[I]||"",p[4]&&(E[I]=E[I].toLowerCase())}d&&(E.query=d(E.query)),m&&g.slashes&&E.pathname.charAt(0)!=="/"&&(E.pathname!==""||g.pathname!=="")&&(E.pathname=C(E.pathname,g.pathname)),E.pathname.charAt(0)!=="/"&&h(E.protocol)&&(E.pathname="/"+E.pathname),u(E.port,E.protocol)||(E.host=E.hostname,E.port=""),E.username=E.password="",E.auth&&(w=E.auth.indexOf(":"),~w?(E.username=E.auth.slice(0,w),E.username=encodeURIComponent(decodeURIComponent(E.username)),E.password=E.auth.slice(w+1),E.password=encodeURIComponent(decodeURIComponent(E.password))):E.username=encodeURIComponent(decodeURIComponent(E.auth)),E.auth=E.password?E.username+":"+E.password:E.username),E.origin=E.protocol!=="file:"&&h(E.protocol)&&E.host?E.protocol+"//"+E.host:"null",E.href=E.toString()}function T(v,g,d){var m=this;switch(v){case"query":typeof g=="string"&&g.length&&(g=(d||e.parse)(g)),m[v]=g;break;case"port":m[v]=g,u(g,m.protocol)?g&&(m.host=m.hostname+":"+g):(m.host=m.hostname,m[v]="");break;case"hostname":m[v]=g,m.port&&(g+=":"+m.port),m.host=g;break;case"host":m[v]=g,c.test(g)?(g=g.split(":"),m.port=g.pop(),m.hostname=g.join(":")):(m.hostname=g,m.port="");break;case"protocol":m.protocol=g.toLowerCase(),m.slashes=!d;break;case"pathname":case"hash":if(g){var x=v==="pathname"?"/":"#";m[v]=g.charAt(0)!==x?x+g:g}else m[v]=g;break;case"username":case"password":m[v]=encodeURIComponent(g);break;case"auth":var y=g.indexOf(":");~y?(m.username=g.slice(0,y),m.username=encodeURIComponent(decodeURIComponent(m.username)),m.password=g.slice(y+1),m.password=encodeURIComponent(decodeURIComponent(m.password))):m.username=encodeURIComponent(decodeURIComponent(g))}for(var p=0;p<n.length;p++){var w=n[p];w[4]&&(m[w[1]]=m[w[1]].toLowerCase())}return m.auth=m.password?m.username+":"+m.password:m.username,m.origin=m.protocol!=="file:"&&h(m.protocol)&&m.host?m.protocol+"//"+m.host:"null",m.href=m.toString(),m}function q(v){(!v||typeof v!="function")&&(v=e.stringify);var g,d=this,m=d.host,x=d.protocol;x&&x.charAt(x.length-1)!==":"&&(x+=":");var y=x+(d.protocol&&d.slashes||h(d.protocol)?"//":"");return d.username?(y+=d.username,d.password&&(y+=":"+d.password),y+="@"):d.password?(y+=":"+d.password,y+="@"):d.protocol!=="file:"&&h(d.protocol)&&!m&&d.pathname!=="/"&&(y+="@"),(m[m.length-1]===":"||c.test(d.hostname)&&!d.port)&&(m+=":"),y+=m+d.pathname,g=typeof d.query=="object"?v(d.query):d.query,g&&(y+=g.charAt(0)!=="?"?"?"+g:g),d.hash&&(y+=d.hash),y}return O.prototype={set:T,toString:q},O.extractProtocol=b,O.location=a,O.trimLeft=l,O.qs=e,se=O,se}var ae,pt;function B(){if(pt)return ae;pt=1;var u=xr();return ae={getOrigin:function(e){if(!e)return null;var i=new u(e);if(i.protocol==="file:")return null;var o=i.port;return o||(o=i.protocol==="https:"?"443":"80"),i.protocol+"//"+i.hostname+":"+o},isOriginEqual:function(e,i){var o=this.getOrigin(e)===this.getOrigin(i);return o},isSchemeEqual:function(e,i){return e.split(":")[0]===i.split(":")[0]},addPath:function(e,i){var o=e.split("?");return o[0]+i+(o[1]?"?"+o[1]:"")},addQuery:function(e,i){return e+(e.indexOf("?")===-1?"?"+i:"&"+i)},isLoopbackAddr:function(e){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^\[::1\]$/.test(e)}},ae}var Z={exports:{}},vt;function A(){return vt||(vt=1,typeof Object.create=="function"?Z.exports=function(e,i){i&&(e.super_=i,e.prototype=Object.create(i.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:Z.exports=function(e,i){if(i){e.super_=i;var o=function(){};o.prototype=i.prototype,e.prototype=new o,e.prototype.constructor=e}}),Z.exports}var ue={},ce,mt;function Ir(){if(mt)return ce;mt=1;function u(){this._listeners={}}return u.prototype.addEventListener=function(e,i){e in this._listeners||(this._listeners[e]=[]);var o=this._listeners[e];o.indexOf(i)===-1&&(o=o.concat([i])),this._listeners[e]=o},u.prototype.removeEventListener=function(e,i){var o=this._listeners[e];if(o){var r=o.indexOf(i);if(r!==-1){o.length>1?this._listeners[e]=o.slice(0,r).concat(o.slice(r+1)):delete this._listeners[e];return}}},u.prototype.dispatchEvent=function(){var e=arguments[0],i=e.type,o=arguments.length===1?[e]:Array.apply(null,arguments);if(this["on"+i]&&this["on"+i].apply(this,o),i in this._listeners)for(var r=this._listeners[i],c=0;c<r.length;c++)r[c].apply(this,o)},ce=u,ce}var gt;function P(){if(gt)return ue;gt=1;var u=A(),e=Ir();function i(){e.call(this)}return u(i,e),i.prototype.removeAllListeners=function(o){o?delete this._listeners[o]:this._listeners={}},i.prototype.once=function(o,r){var c=this,s=!1;function f(){c.removeListener(o,f),s||(s=!0,r.apply(this,arguments))}this.on(o,f)},i.prototype.emit=function(){var o=arguments[0],r=this._listeners[o];if(r){for(var c=arguments.length,s=new Array(c-1),f=1;f<c;f++)s[f-1]=arguments[f];for(var l=0;l<r.length;l++)r[l].apply(this,s)}},i.prototype.on=i.prototype.addListener=e.prototype.addEventListener,i.prototype.removeListener=e.prototype.removeEventListener,ue.EventEmitter=i,ue}var Y={exports:{}},bt;function Dr(){if(bt)return Y.exports;bt=1;var u=_.WebSocket||_.MozWebSocket;return u?Y.exports=function(i){return new u(i)}:Y.exports=void 0,Y.exports}var le,yt;function Xr(){if(yt)return le;yt=1;var u=D(),e=B(),i=A(),o=P().EventEmitter,r=Dr(),c=function(){};function s(f,l,n){if(!s.enabled())throw new Error("Transport created when disabled");o.call(this);var t=this,a=e.addPath(f,"/websocket");a.slice(0,5)==="https"?a="wss"+a.slice(5):a="ws"+a.slice(4),this.url=a,this.ws=new r(this.url,[],n),this.ws.onmessage=function(h){c("message event",h.data),t.emit("message",h.data)},this.unloadRef=u.unloadAdd(function(){t.ws.close()}),this.ws.onclose=function(h){c("close event",h.code,h.reason),t.emit("close",h.code,h.reason),t._cleanup()},this.ws.onerror=function(h){t.emit("close",1006,"WebSocket connection broken"),t._cleanup()}}return i(s,o),s.prototype.send=function(f){var l="["+f+"]";this.ws.send(l)},s.prototype.close=function(){var f=this.ws;this._cleanup(),f&&f.close()},s.prototype._cleanup=function(){var f=this.ws;f&&(f.onmessage=f.onclose=f.onerror=null),u.unloadDel(this.unloadRef),this.unloadRef=this.ws=null,this.removeAllListeners()},s.enabled=function(){return!!r},s.transportName="websocket",s.roundTrips=2,le=s,le}var fe,wt;function Mr(){if(wt)return fe;wt=1;var u=A(),e=P().EventEmitter,i=function(){};function o(r,c){e.call(this),this.sendBuffer=[],this.sender=c,this.url=r}return u(o,e),o.prototype.send=function(r){this.sendBuffer.push(r),this.sendStop||this.sendSchedule()},o.prototype.sendScheduleWait=function(){var r=this,c;this.sendStop=function(){r.sendStop=null,clearTimeout(c)},c=setTimeout(function(){r.sendStop=null,r.sendSchedule()},25)},o.prototype.sendSchedule=function(){i("sendSchedule",this.sendBuffer.length);var r=this;if(this.sendBuffer.length>0){var c="["+this.sendBuffer.join(",")+"]";this.sendStop=this.sender(this.url,c,function(s){r.sendStop=null,s?(r.emit("close",s.code||1006,"Sending error: "+s),r.close()):r.sendScheduleWait()}),this.sendBuffer=[]}},o.prototype._cleanup=function(){this.removeAllListeners()},o.prototype.close=function(){this._cleanup(),this.sendStop&&(this.sendStop(),this.sendStop=null)},fe=o,fe}var he,_t;function Fr(){if(_t)return he;_t=1;var u=A(),e=P().EventEmitter,i=function(){};function o(r,c,s){e.call(this),this.Receiver=r,this.receiveUrl=c,this.AjaxObject=s,this._scheduleReceiver()}return u(o,e),o.prototype._scheduleReceiver=function(){var r=this,c=this.poll=new this.Receiver(this.receiveUrl,this.AjaxObject);c.on("message",function(s){r.emit("message",s)}),c.once("close",function(s,f){i("close",s,f,r.pollIsClosing),r.poll=c=null,r.pollIsClosing||(f==="network"?r._scheduleReceiver():(r.emit("close",s||1006,f),r.removeAllListeners()))})},o.prototype.abort=function(){this.removeAllListeners(),this.pollIsClosing=!0,this.poll&&this.poll.abort()},he=o,he}var de,Et;function Rr(){if(Et)return de;Et=1;var u=A(),e=B(),i=Mr(),o=Fr();function r(c,s,f,l,n){var t=e.addPath(c,s),a=this;i.call(this,c,f),this.poll=new o(l,t,n),this.poll.on("message",function(h){a.emit("message",h)}),this.poll.once("close",function(h,b){a.poll=null,a.emit("close",h,b),a.close()})}return u(r,i),r.prototype.close=function(){i.prototype.close.call(this),this.removeAllListeners(),this.poll&&(this.poll.abort(),this.poll=null)},de=r,de}var pe,St;function W(){if(St)return pe;St=1;var u=A(),e=B(),i=Rr();function o(c){return function(s,f,l){var n={};typeof f=="string"&&(n.headers={"Content-type":"text/plain"});var t=e.addPath(s,"/xhr_send"),a=new c("POST",t,f,n);return a.once("finish",function(h){if(a=null,h!==200&&h!==204)return l(new Error("http status "+h));l()}),function(){a.close(),a=null;var h=new Error("Aborted");h.code=1e3,l(h)}}}function r(c,s,f,l){i.call(this,c,s,o(l),f,l)}return u(r,i),pe=r,pe}var ve,xt;function te(){if(xt)return ve;xt=1;var u=A(),e=P().EventEmitter;function i(o,r){e.call(this);var c=this;this.bufferPosition=0,this.xo=new r("POST",o,null),this.xo.on("chunk",this._chunkHandler.bind(this)),this.xo.once("finish",function(s,f){c._chunkHandler(s,f),c.xo=null;var l=s===200?"network":"permanent";c.emit("close",null,l),c._cleanup()})}return u(i,e),i.prototype._chunkHandler=function(o,r){if(!(o!==200||!r))for(var c=-1;;this.bufferPosition+=c+1){var s=r.slice(this.bufferPosition);if(c=s.indexOf(`
`),c===-1)break;var f=s.slice(0,c);f&&this.emit("message",f)}},i.prototype._cleanup=function(){this.removeAllListeners()},i.prototype.abort=function(){this.xo&&(this.xo.close(),this.emit("close",null,"user"),this.xo=null),this._cleanup()},ve=i,ve}var me,It;function Or(){if(It)return me;It=1;var u=P().EventEmitter,e=A(),i=D(),o=B(),r=_.XMLHttpRequest,c=function(){};function s(n,t,a,h){var b=this;u.call(this),setTimeout(function(){b._start(n,t,a,h)},0)}e(s,u),s.prototype._start=function(n,t,a,h){var b=this;try{this.xhr=new r}catch{}if(!this.xhr){this.emit("finish",0,"no xhr support"),this._cleanup();return}t=o.addQuery(t,"t="+ +new Date),this.unloadRef=i.unloadAdd(function(){b._cleanup(!0)});try{this.xhr.open(n,t,!0),this.timeout&&"timeout"in this.xhr&&(this.xhr.timeout=this.timeout,this.xhr.ontimeout=function(){c("xhr timeout"),b.emit("finish",0,""),b._cleanup(!1)})}catch{this.emit("finish",0,""),this._cleanup(!1);return}if((!h||!h.noCredentials)&&s.supportsCORS&&(this.xhr.withCredentials=!0),h&&h.headers)for(var C in h.headers)this.xhr.setRequestHeader(C,h.headers[C]);this.xhr.onreadystatechange=function(){if(b.xhr){var O=b.xhr,T,q;switch(c("readyState",O.readyState),O.readyState){case 3:try{q=O.status,T=O.responseText}catch{}q===1223&&(q=204),q===200&&T&&T.length>0&&b.emit("chunk",q,T);break;case 4:q=O.status,q===1223&&(q=204),(q===12005||q===12029)&&(q=0),c("finish",q,O.responseText),b.emit("finish",q,O.responseText),b._cleanup(!1);break}}};try{b.xhr.send(a)}catch{b.emit("finish",0,""),b._cleanup(!1)}},s.prototype._cleanup=function(n){if(this.xhr){if(this.removeAllListeners(),i.unloadDel(this.unloadRef),this.xhr.onreadystatechange=function(){},this.xhr.ontimeout&&(this.xhr.ontimeout=null),n)try{this.xhr.abort()}catch{}this.unloadRef=this.xhr=null}},s.prototype.close=function(){this._cleanup(!0)},s.enabled=!!r;var f=["Active"].concat("Object").join("X");!s.enabled&&f in _&&(r=function(){try{return new _[f]("Microsoft.XMLHTTP")}catch{return null}},s.enabled=!!new r);var l=!1;try{l="withCredentials"in new r}catch{}return s.supportsCORS=l,me=s,me}var ge,Rt;function re(){if(Rt)return ge;Rt=1;var u=A(),e=Or();function i(o,r,c,s){e.call(this,o,r,c,s)}return u(i,e),i.enabled=e.enabled&&e.supportsCORS,ge=i,ge}var be,Ot;function G(){if(Ot)return be;Ot=1;var u=A(),e=Or();function i(o,r,c){e.call(this,o,r,c,{noCredentials:!0})}return u(i,e),i.enabled=e.enabled,be=i,be}var ye,Tt;function V(){return Tt||(Tt=1,ye={isOpera:function(){return _.navigator&&/opera/i.test(_.navigator.userAgent)},isKonqueror:function(){return _.navigator&&/konqueror/i.test(_.navigator.userAgent)},hasDomain:function(){if(!_.document)return!0;try{return!!_.document.domain}catch{return!1}}}),ye}var we,Nt;function Wr(){if(Nt)return we;Nt=1;var u=A(),e=W(),i=te(),o=re(),r=G(),c=V();function s(f){if(!r.enabled&&!o.enabled)throw new Error("Transport created when disabled");e.call(this,f,"/xhr_streaming",i,o)}return u(s,e),s.enabled=function(f){return f.nullOrigin||c.isOpera()?!1:o.enabled},s.transportName="xhr-streaming",s.roundTrips=2,s.needBody=!!_.document,we=s,we}var _e,Ct;function ot(){if(Ct)return _e;Ct=1;var u=P().EventEmitter,e=A(),i=D(),o=V(),r=B(),c=function(){};function s(f,l,n){var t=this;u.call(this),setTimeout(function(){t._start(f,l,n)},0)}return e(s,u),s.prototype._start=function(f,l,n){var t=this,a=new _.XDomainRequest;l=r.addQuery(l,"t="+ +new Date),a.onerror=function(){t._error()},a.ontimeout=function(){t._error()},a.onprogress=function(){c("progress",a.responseText),t.emit("chunk",200,a.responseText)},a.onload=function(){t.emit("finish",200,a.responseText),t._cleanup(!1)},this.xdr=a,this.unloadRef=i.unloadAdd(function(){t._cleanup(!0)});try{this.xdr.open(f,l),this.timeout&&(this.xdr.timeout=this.timeout),this.xdr.send(n)}catch{this._error()}},s.prototype._error=function(){this.emit("finish",0,""),this._cleanup(!1)},s.prototype._cleanup=function(f){if(this.xdr){if(this.removeAllListeners(),i.unloadDel(this.unloadRef),this.xdr.ontimeout=this.xdr.onerror=this.xdr.onprogress=this.xdr.onload=null,f)try{this.xdr.abort()}catch{}this.unloadRef=this.xdr=null}},s.prototype.close=function(){this._cleanup(!0)},s.enabled=!!(_.XDomainRequest&&o.hasDomain()),_e=s,_e}var Ee,qt;function Tr(){if(qt)return Ee;qt=1;var u=A(),e=W(),i=te(),o=ot();function r(c){if(!o.enabled)throw new Error("Transport created when disabled");e.call(this,c,"/xhr_streaming",i,o)}return u(r,e),r.enabled=function(c){return c.cookie_needed||c.nullOrigin?!1:o.enabled&&c.sameScheme},r.transportName="xdr-streaming",r.roundTrips=2,Ee=r,Ee}var Se,At;function Nr(){return At||(At=1,Se=_.EventSource),Se}var xe,kt;function Hr(){if(kt)return xe;kt=1;var u=A(),e=P().EventEmitter,i=Nr(),o=function(){};function r(c){e.call(this);var s=this,f=this.es=new i(c);f.onmessage=function(l){o("message",l.data),s.emit("message",decodeURI(l.data))},f.onerror=function(l){o("error",f.readyState);var n=f.readyState!==2?"network":"permanent";s._cleanup(),s._close(n)}}return u(r,e),r.prototype.abort=function(){this._cleanup(),this._close("user")},r.prototype._cleanup=function(){var c=this.es;c&&(c.onmessage=c.onerror=null,c.close(),this.es=null)},r.prototype._close=function(c){var s=this;setTimeout(function(){s.emit("close",null,c),s.removeAllListeners()},200)},xe=r,xe}var Ie,jt;function Lt(){if(jt)return Ie;jt=1;var u=A(),e=W(),i=Hr(),o=re(),r=Nr();function c(s){if(!c.enabled())throw new Error("Transport created when disabled");e.call(this,s,"/eventsource",i,o)}return u(c,e),c.enabled=function(){return!!r},c.transportName="eventsource",c.roundTrips=2,Ie=c,Ie}var Re,Pt;function Cr(){return Pt||(Pt=1,Re="1.6.1"),Re}var Oe={exports:{}},Ut;function z(){return Ut||(Ut=1,(function(u){var e=D(),i=V();u.exports={WPrefix:"_jp",currentWindowId:null,polluteGlobalNamespace:function(){u.exports.WPrefix in _||(_[u.exports.WPrefix]={})},postMessage:function(o,r){_.parent!==_&&_.parent.postMessage(JSON.stringify({windowId:u.exports.currentWindowId,type:o,data:r||""}),"*")},createIframe:function(o,r){var c=_.document.createElement("iframe"),s,f,l=function(){clearTimeout(s);try{c.onload=null}catch{}c.onerror=null},n=function(){c&&(l(),setTimeout(function(){c&&c.parentNode.removeChild(c),c=null},0),e.unloadDel(f))},t=function(h){c&&(n(),r(h))},a=function(h,b){setTimeout(function(){try{c&&c.contentWindow&&c.contentWindow.postMessage(h,b)}catch{}},0)};return c.src=o,c.style.display="none",c.style.position="absolute",c.onerror=function(){t("onerror")},c.onload=function(){clearTimeout(s),s=setTimeout(function(){t("onload timeout")},2e3)},_.document.body.appendChild(c),s=setTimeout(function(){t("timeout")},15e3),f=e.unloadAdd(n),{post:a,cleanup:n,loaded:l}},createHtmlfile:function(o,r){var c=["Active"].concat("Object").join("X"),s=new _[c]("htmlfile"),f,l,n,t=function(){clearTimeout(f),n.onerror=null},a=function(){s&&(t(),e.unloadDel(l),n.parentNode.removeChild(n),n=s=null,CollectGarbage())},h=function(O){s&&(a(),r(O))},b=function(O,T){try{setTimeout(function(){n&&n.contentWindow&&n.contentWindow.postMessage(O,T)},0)}catch{}};s.open(),s.write('<html><script>document.domain="'+_.document.domain+'";<\/script></html>'),s.close(),s.parentWindow[u.exports.WPrefix]=_[u.exports.WPrefix];var C=s.createElement("div");return s.body.appendChild(C),n=s.createElement("iframe"),C.appendChild(n),n.src=o,n.onerror=function(){h("onerror")},f=setTimeout(function(){h("timeout")},15e3),l=e.unloadAdd(a),{post:b,cleanup:a,loaded:t}}},u.exports.iframeEnabled=!1,_.document&&(u.exports.iframeEnabled=(typeof _.postMessage=="function"||typeof _.postMessage=="object")&&!i.isKonqueror())})(Oe)),Oe.exports}var Te,$t;function qr(){if($t)return Te;$t=1;var u=A(),e=P().EventEmitter,i=Cr(),o=B(),r=z(),c=D(),s=F(),f=function(){};function l(n,t,a){if(!l.enabled())throw new Error("Transport created when disabled");e.call(this);var h=this;this.origin=o.getOrigin(a),this.baseUrl=a,this.transUrl=t,this.transport=n,this.windowId=s.string(8);var b=o.addPath(a,"/iframe.html")+"#"+this.windowId;this.iframeObj=r.createIframe(b,function(C){h.emit("close",1006,"Unable to load an iframe ("+C+")"),h.close()}),this.onmessageCallback=this._message.bind(this),c.attachEvent("message",this.onmessageCallback)}return u(l,e),l.prototype.close=function(){if(this.removeAllListeners(),this.iframeObj){c.detachEvent("message",this.onmessageCallback);try{this.postMessage("c")}catch{}this.iframeObj.cleanup(),this.iframeObj=null,this.onmessageCallback=this.iframeObj=null}},l.prototype._message=function(n){if(f("message",n.data),!o.isOriginEqual(n.origin,this.origin)){f("not same origin",n.origin,this.origin);return}var t;try{t=JSON.parse(n.data)}catch{f("bad json",n.data);return}if(t.windowId!==this.windowId){f("mismatched window id",t.windowId,this.windowId);return}switch(t.type){case"s":this.iframeObj.loaded(),this.postMessage("s",JSON.stringify([i,this.transport,this.transUrl,this.baseUrl]));break;case"t":this.emit("message",t.data);break;case"c":var a;try{a=JSON.parse(t.data)}catch{f("bad json",t.data);return}this.emit("close",a[0],a[1]),this.close();break}},l.prototype.postMessage=function(n,t){this.iframeObj.post(JSON.stringify({windowId:this.windowId,type:n,data:t||""}),this.origin)},l.prototype.send=function(n){this.postMessage("m",n)},l.enabled=function(){return r.iframeEnabled},l.transportName="iframe",l.roundTrips=2,Te=l,Te}var Ne,Bt;function st(){return Bt||(Bt=1,Ne={isObject:function(u){var e=typeof u;return e==="function"||e==="object"&&!!u},extend:function(u){if(!this.isObject(u))return u;for(var e,i,o=1,r=arguments.length;o<r;o++){e=arguments[o];for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&(u[i]=e[i])}return u}}),Ne}var Ce,Dt;function qe(){if(Dt)return Ce;Dt=1;var u=A(),e=qr(),i=st();return Ce=function(o){function r(c,s){e.call(this,o.transportName,c,s)}return u(r,e),r.enabled=function(c,s){if(!_.document)return!1;var f=i.extend({},s);return f.sameOrigin=!0,o.enabled(f)&&e.enabled()},r.transportName="iframe-"+o.transportName,r.needBody=!0,r.roundTrips=e.roundTrips+o.roundTrips-1,r.facadeTransport=o,r},Ce}var Ae,Xt;function Jr(){if(Xt)return Ae;Xt=1;var u=A(),e=z(),i=B(),o=P().EventEmitter,r=F(),c=function(){};function s(l){o.call(this);var n=this;e.polluteGlobalNamespace(),this.id="a"+r.string(6),l=i.addQuery(l,"c="+decodeURIComponent(e.WPrefix+"."+this.id)),c("using htmlfile",s.htmlfileEnabled);var t=s.htmlfileEnabled?e.createHtmlfile:e.createIframe;_[e.WPrefix][this.id]={start:function(){n.iframeObj.loaded()},message:function(a){n.emit("message",a)},stop:function(){n._cleanup(),n._close("network")}},this.iframeObj=t(l,function(){n._cleanup(),n._close("permanent")})}u(s,o),s.prototype.abort=function(){this._cleanup(),this._close("user")},s.prototype._cleanup=function(){this.iframeObj&&(this.iframeObj.cleanup(),this.iframeObj=null),delete _[e.WPrefix][this.id]},s.prototype._close=function(l){this.emit("close",null,l),this.removeAllListeners()},s.htmlfileEnabled=!1;var f=["Active"].concat("Object").join("X");if(f in _)try{s.htmlfileEnabled=!!new _[f]("htmlfile")}catch{}return s.enabled=s.htmlfileEnabled||e.iframeEnabled,Ae=s,Ae}var ke,Mt;function Ft(){if(Mt)return ke;Mt=1;var u=A(),e=Jr(),i=G(),o=W();function r(c){if(!e.enabled)throw new Error("Transport created when disabled");o.call(this,c,"/htmlfile",e,i)}return u(r,o),r.enabled=function(c){return e.enabled&&c.sameOrigin},r.transportName="htmlfile",r.roundTrips=2,ke=r,ke}var je,Wt;function Ht(){if(Wt)return je;Wt=1;var u=A(),e=W(),i=te(),o=re(),r=G();function c(s){if(!r.enabled&&!o.enabled)throw new Error("Transport created when disabled");e.call(this,s,"/xhr",i,o)}return u(c,e),c.enabled=function(s){return s.nullOrigin?!1:r.enabled&&s.sameOrigin?!0:o.enabled},c.transportName="xhr-polling",c.roundTrips=2,je=c,je}var Le,Jt;function Gr(){if(Jt)return Le;Jt=1;var u=A(),e=W(),i=Tr(),o=te(),r=ot();function c(s){if(!r.enabled)throw new Error("Transport created when disabled");e.call(this,s,"/xhr",o,r)}return u(c,e),c.enabled=i.enabled,c.transportName="xdr-polling",c.roundTrips=2,Le=c,Le}var Pe,Gt;function Vr(){if(Gt)return Pe;Gt=1;var u=z(),e=F(),i=V(),o=B(),r=A(),c=P().EventEmitter,s=function(){};function f(l){var n=this;c.call(this),u.polluteGlobalNamespace(),this.id="a"+e.string(6);var t=o.addQuery(l,"c="+encodeURIComponent(u.WPrefix+"."+this.id));_[u.WPrefix][this.id]=this._callback.bind(this),this._createScript(t),this.timeoutId=setTimeout(function(){n._abort(new Error("JSONP script loaded abnormally (timeout)"))},f.timeout)}return r(f,c),f.prototype.abort=function(){if(_[u.WPrefix][this.id]){var l=new Error("JSONP user aborted read");l.code=1e3,this._abort(l)}},f.timeout=35e3,f.scriptErrorTimeout=1e3,f.prototype._callback=function(l){this._cleanup(),!this.aborting&&(l&&this.emit("message",l),this.emit("close",null,"network"),this.removeAllListeners())},f.prototype._abort=function(l){this._cleanup(),this.aborting=!0,this.emit("close",l.code,l.message),this.removeAllListeners()},f.prototype._cleanup=function(){if(clearTimeout(this.timeoutId),this.script2&&(this.script2.parentNode.removeChild(this.script2),this.script2=null),this.script){var l=this.script;l.parentNode.removeChild(l),l.onreadystatechange=l.onerror=l.onload=l.onclick=null,this.script=null}delete _[u.WPrefix][this.id]},f.prototype._scriptError=function(){var l=this;this.errorTimer||(this.errorTimer=setTimeout(function(){l.loadedOkay||l._abort(new Error("JSONP script loaded abnormally (onerror)"))},f.scriptErrorTimeout))},f.prototype._createScript=function(l){var n=this,t=this.script=_.document.createElement("script"),a;if(t.id="a"+e.string(8),t.src=l,t.type="text/javascript",t.charset="UTF-8",t.onerror=this._scriptError.bind(this),t.onload=function(){n._abort(new Error("JSONP script loaded abnormally (onload)"))},t.onreadystatechange=function(){if(s("onreadystatechange",t.readyState),/loaded|closed/.test(t.readyState)){if(t&&t.htmlFor&&t.onclick){n.loadedOkay=!0;try{t.onclick()}catch{}}t&&n._abort(new Error("JSONP script loaded abnormally (onreadystatechange)"))}},typeof t.async>"u"&&_.document.attachEvent)if(i.isOpera())a=this.script2=_.document.createElement("script"),a.text="try{var a = document.getElementById('"+t.id+"'); if(a)a.onerror();}catch(x){};",t.async=a.async=!1;else{try{t.htmlFor=t.id,t.event="onclick"}catch{}t.async=!0}typeof t.async<"u"&&(t.async=!0);var h=_.document.getElementsByTagName("head")[0];h.insertBefore(t,h.firstChild),a&&h.insertBefore(a,h.firstChild)},Pe=f,Pe}var Ue,Vt;function zr(){if(Vt)return Ue;Vt=1;var u=F(),e=B(),i=function(){},o,r;function c(f){try{return _.document.createElement('<iframe name="'+f+'">')}catch{var l=_.document.createElement("iframe");return l.name=f,l}}function s(){o=_.document.createElement("form"),o.style.display="none",o.style.position="absolute",o.method="POST",o.enctype="application/x-www-form-urlencoded",o.acceptCharset="UTF-8",r=_.document.createElement("textarea"),r.name="d",o.appendChild(r),_.document.body.appendChild(o)}return Ue=function(f,l,n){o||s();var t="a"+u.string(8);o.target=t,o.action=e.addQuery(e.addPath(f,"/jsonp_send"),"i="+t);var a=c(t);a.id=t,a.style.display="none",o.appendChild(a);try{r.value=l}catch{}o.submit();var h=function(b){a.onerror&&(a.onreadystatechange=a.onerror=a.onload=null,setTimeout(function(){a.parentNode.removeChild(a),a=null},500),r.value="",n(b))};return a.onerror=function(){h()},a.onload=function(){h()},a.onreadystatechange=function(b){i("onreadystatechange",t,a.readyState),a.readyState==="complete"&&h()},function(){h(new Error("Aborted"))}},Ue}var $e,zt;function Qr(){if(zt)return $e;zt=1;var u=A(),e=Rr(),i=Vr(),o=zr();function r(c){if(!r.enabled())throw new Error("Transport created when disabled");e.call(this,c,"/jsonp",o,i)}return u(r,e),r.enabled=function(){return!!_.document},r.transportName="jsonp-polling",r.roundTrips=1,r.needBody=!0,$e=r,$e}var Be,Qt;function Kr(){return Qt||(Qt=1,Be=[Xr(),Wr(),Tr(),Lt(),qe()(Lt()),Ft(),qe()(Ft()),Ht(),Gr(),qe()(Ht()),Qr()]),Be}var Kt={},Zt;function Zr(){if(Zt)return Kt;Zt=1;var u=Array.prototype,e=Object.prototype,i=Function.prototype,o=String.prototype,r=u.slice,c=e.toString,s=function(y){return e.toString.call(y)==="[object Function]"},f=function(p){return c.call(p)==="[object Array]"},l=function(p){return c.call(p)==="[object String]"},n=Object.defineProperty&&(function(){try{return Object.defineProperty({},"x",{}),!0}catch{return!1}})(),t;n?t=function(y,p,w,I){!I&&p in y||Object.defineProperty(y,p,{configurable:!0,enumerable:!1,writable:!0,value:w})}:t=function(y,p,w,I){!I&&p in y||(y[p]=w)};var a=function(y,p,w){for(var I in p)e.hasOwnProperty.call(p,I)&&t(y,I,p[I],w)},h=function(y){if(y==null)throw new TypeError("can't convert "+y+" to object");return Object(y)};function b(y){var p=+y;return p!==p?p=0:p!==0&&p!==1/0&&p!==-1/0&&(p=(p>0||-1)*Math.floor(Math.abs(p))),p}function C(y){return y>>>0}function O(){}a(i,{bind:function(p){var w=this;if(!s(w))throw new TypeError("Function.prototype.bind called on incompatible "+w);for(var I=r.call(arguments,1),N=function(){if(this instanceof R){var k=w.apply(this,I.concat(r.call(arguments)));return Object(k)===k?k:this}else return w.apply(p,I.concat(r.call(arguments)))},j=Math.max(0,w.length-I.length),E=[],S=0;S<j;S++)E.push("$"+S);var R=Function("binder","return function ("+E.join(",")+"){ return binder.apply(this, arguments); }")(N);return w.prototype&&(O.prototype=w.prototype,R.prototype=new O,O.prototype=null),R}}),a(Array,{isArray:f});var T=Object("a"),q=T[0]!=="a"||!(0 in T),v=function(p){var w=!0,I=!0;return p&&(p.call("foo",function(N,j,E){typeof E!="object"&&(w=!1)}),p.call([1],function(){I=typeof this=="string"},"x")),!!p&&w&&I};a(u,{forEach:function(p){var w=h(this),I=q&&l(this)?this.split(""):w,N=arguments[1],j=-1,E=I.length>>>0;if(!s(p))throw new TypeError;for(;++j<E;)j in I&&p.call(N,I[j],j,w)}},!v(u.forEach));var g=Array.prototype.indexOf&&[0,1].indexOf(1,2)!==-1;a(u,{indexOf:function(p){var w=q&&l(this)?this.split(""):h(this),I=w.length>>>0;if(!I)return-1;var N=0;for(arguments.length>1&&(N=b(arguments[1])),N=N>=0?N:Math.max(0,I+N);N<I;N++)if(N in w&&w[N]===p)return N;return-1}},g);var d=o.split;"ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||"tesst".split(/(s)*/)[1]==="t"||"test".split(/(?:)/,-1).length!==4||"".split(/.?/).length||".".split(/()()/).length>1?(function(){var y=/()??/.exec("")[1]===void 0;o.split=function(p,w){var I=this;if(p===void 0&&w===0)return[];if(c.call(p)!=="[object RegExp]")return d.call(this,p,w);var N=[],j=(p.ignoreCase?"i":"")+(p.multiline?"m":"")+(p.extended?"x":"")+(p.sticky?"y":""),E=0,S,R,k,U;for(p=new RegExp(p.source,j+"g"),I+="",y||(S=new RegExp("^"+p.source+"$(?!\\s)",j)),w=w===void 0?-1>>>0:C(w);(R=p.exec(I))&&(k=R.index+R[0].length,!(k>E&&(N.push(I.slice(E,R.index)),!y&&R.length>1&&R[0].replace(S,function(){for(var $=1;$<arguments.length-2;$++)arguments[$]===void 0&&(R[$]=void 0)}),R.length>1&&R.index<I.length&&u.push.apply(N,R.slice(1)),U=R[0].length,E=k,N.length>=w)));)p.lastIndex===R.index&&p.lastIndex++;return E===I.length?(U||!p.test(""))&&N.push(""):N.push(I.slice(E)),N.length>w?N.slice(0,w):N}})():"0".split(void 0,0).length&&(o.split=function(p,w){return p===void 0&&w===0?[]:d.call(this,p,w)});var m=o.substr,x="".substr&&"0b".substr(-1)!=="b";return a(o,{substr:function(p,w){return m.call(this,p<0&&(p=this.length+p)<0?0:p,w)}},x),Kt}var De,Yt;function Yr(){if(Yt)return De;Yt=1;var u=/[\x00-\x1f\ud800-\udfff\ufffe\uffff\u0300-\u0333\u033d-\u0346\u034a-\u034c\u0350-\u0352\u0357-\u0358\u035c-\u0362\u0374\u037e\u0387\u0591-\u05af\u05c4\u0610-\u0617\u0653-\u0654\u0657-\u065b\u065d-\u065e\u06df-\u06e2\u06eb-\u06ec\u0730\u0732-\u0733\u0735-\u0736\u073a\u073d\u073f-\u0741\u0743\u0745\u0747\u07eb-\u07f1\u0951\u0958-\u095f\u09dc-\u09dd\u09df\u0a33\u0a36\u0a59-\u0a5b\u0a5e\u0b5c-\u0b5d\u0e38-\u0e39\u0f43\u0f4d\u0f52\u0f57\u0f5c\u0f69\u0f72-\u0f76\u0f78\u0f80-\u0f83\u0f93\u0f9d\u0fa2\u0fa7\u0fac\u0fb9\u1939-\u193a\u1a17\u1b6b\u1cda-\u1cdb\u1dc0-\u1dcf\u1dfc\u1dfe\u1f71\u1f73\u1f75\u1f77\u1f79\u1f7b\u1f7d\u1fbb\u1fbe\u1fc9\u1fcb\u1fd3\u1fdb\u1fe3\u1feb\u1fee-\u1fef\u1ff9\u1ffb\u1ffd\u2000-\u2001\u20d0-\u20d1\u20d4-\u20d7\u20e7-\u20e9\u2126\u212a-\u212b\u2329-\u232a\u2adc\u302b-\u302c\uaab2-\uaab3\uf900-\ufa0d\ufa10\ufa12\ufa15-\ufa1e\ufa20\ufa22\ufa25-\ufa26\ufa2a-\ufa2d\ufa30-\ufa6d\ufa70-\ufad9\ufb1d\ufb1f\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4e\ufff0-\uffff]/g,e,i=function(o){var r,c={},s=[];for(r=0;r<65536;r++)s.push(String.fromCharCode(r));return o.lastIndex=0,s.join("").replace(o,function(f){return c[f]="\\u"+("0000"+f.charCodeAt(0).toString(16)).slice(-4),""}),o.lastIndex=0,c};return De={quote:function(o){var r=JSON.stringify(o);return u.lastIndex=0,u.test(r)?(e||(e=i(u)),r.replace(u,function(c){return e[c]})):r}},De}var Xe,er;function en(){if(er)return Xe;er=1;var u=function(){};return Xe=function(e){return{filterToEnabled:function(i,o){var r={main:[],facade:[]};return i?typeof i=="string"&&(i=[i]):i=[],e.forEach(function(c){if(c&&!(c.transportName==="websocket"&&o.websocket===!1)){if(i.length&&i.indexOf(c.transportName)===-1){u("not in whitelist",c.transportName);return}c.enabled(o)?(u("enabled",c.transportName),r.main.push(c),c.facadeTransport&&r.facade.push(c.facadeTransport)):u("disabled",c.transportName)}}),r}}},Xe}var Me,tr;function tn(){if(tr)return Me;tr=1;var u={};return["log","debug","warn"].forEach(function(e){var i;try{i=_.console&&_.console[e]&&_.console[e].apply}catch{}u[e]=i?function(){return _.console[e].apply(_.console,arguments)}:e==="log"?function(){}:u.log}),Me=u,Me}var Fe,rr;function at(){if(rr)return Fe;rr=1;function u(e){this.type=e}return u.prototype.initEvent=function(e,i,o){return this.type=e,this.bubbles=i,this.cancelable=o,this.timeStamp=+new Date,this},u.prototype.stopPropagation=function(){},u.prototype.preventDefault=function(){},u.CAPTURING_PHASE=1,u.AT_TARGET=2,u.BUBBLING_PHASE=3,Fe=u,Fe}var We,nr;function Ar(){return nr||(nr=1,We=_.location||{origin:"http://localhost:80",protocol:"http:",host:"localhost",port:80,href:"http://localhost/",hash:""}),We}var He,ir;function rn(){if(ir)return He;ir=1;var u=A(),e=at();function i(){e.call(this),this.initEvent("close",!1,!1),this.wasClean=!1,this.code=0,this.reason=""}return u(i,e),He=i,He}var Je,or;function nn(){if(or)return Je;or=1;var u=A(),e=at();function i(o){e.call(this),this.initEvent("message",!1,!1),this.data=o}return u(i,e),Je=i,Je}var Ge,sr;function on(){if(sr)return Ge;sr=1;var u=P().EventEmitter,e=A();function i(){var o=this;u.call(this),this.to=setTimeout(function(){o.emit("finish",200,"{}")},i.timeout)}return e(i,u),i.prototype.close=function(){clearTimeout(this.to)},i.timeout=2e3,Ge=i,Ge}var Ve,ar;function kr(){if(ar)return Ve;ar=1;var u=P().EventEmitter,e=A(),i=st();function o(r,c){u.call(this);var s=this,f=+new Date;this.xo=new c("GET",r),this.xo.once("finish",function(l,n){var t,a;if(l===200){if(a=+new Date-f,n)try{t=JSON.parse(n)}catch{}i.isObject(t)||(t={})}s.emit("finish",t,a),s.removeAllListeners()})}return e(o,u),o.prototype.close=function(){this.removeAllListeners(),this.xo.close()},Ve=o,Ve}var ze,ur;function jr(){if(ur)return ze;ur=1;var u=A(),e=P().EventEmitter,i=G(),o=kr();function r(c){var s=this;e.call(this),this.ir=new o(c,i),this.ir.once("finish",function(f,l){s.ir=null,s.emit("message",JSON.stringify([f,l]))})}return u(r,e),r.transportName="iframe-info-receiver",r.prototype.close=function(){this.ir&&(this.ir.close(),this.ir=null),this.removeAllListeners()},ze=r,ze}var Qe,cr;function sn(){if(cr)return Qe;cr=1;var u=P().EventEmitter,e=A(),i=D(),o=qr(),r=jr();function c(s,f){var l=this;u.call(this);var n=function(){var t=l.ifr=new o(r.transportName,f,s);t.once("message",function(a){if(a){var h;try{h=JSON.parse(a)}catch{l.emit("finish"),l.close();return}var b=h[0],C=h[1];l.emit("finish",b,C)}l.close()}),t.once("close",function(){l.emit("finish"),l.close()})};_.document.body?n():i.attachEvent("load",n)}return e(c,u),c.enabled=function(){return o.enabled()},c.prototype.close=function(){this.ifr&&this.ifr.close(),this.removeAllListeners(),this.ifr=null},Qe=c,Qe}var Ke,lr;function an(){if(lr)return Ke;lr=1;var u=P().EventEmitter,e=A(),i=B(),o=ot(),r=re(),c=G(),s=on(),f=sn(),l=kr();function n(t,a){var h=this;u.call(this),setTimeout(function(){h.doXhr(t,a)},0)}return e(n,u),n._getReceiver=function(t,a,h){return h.sameOrigin?new l(a,c):r.enabled?new l(a,r):o.enabled&&h.sameScheme?new l(a,o):f.enabled()?new f(t,a):new l(a,s)},n.prototype.doXhr=function(t,a){var h=this,b=i.addPath(t,"/info");this.xo=n._getReceiver(t,b,a),this.timeoutRef=setTimeout(function(){h._cleanup(!1),h.emit("finish")},n.timeout),this.xo.once("finish",function(C,O){h._cleanup(!0),h.emit("finish",C,O)})},n.prototype._cleanup=function(t){clearTimeout(this.timeoutRef),this.timeoutRef=null,!t&&this.xo&&this.xo.close(),this.xo=null},n.prototype.close=function(){this.removeAllListeners(),this._cleanup(!1)},n.timeout=8e3,Ke=n,Ke}var Ze,fr;function un(){if(fr)return Ze;fr=1;var u=z();function e(i){this._transport=i,i.on("message",this._transportMessage.bind(this)),i.on("close",this._transportClose.bind(this))}return e.prototype._transportClose=function(i,o){u.postMessage("c",JSON.stringify([i,o]))},e.prototype._transportMessage=function(i){u.postMessage("t",i)},e.prototype._send=function(i){this._transport.send(i)},e.prototype._close=function(){this._transport.close(),this._transport.removeAllListeners()},Ze=e,Ze}var Ye,hr;function cn(){if(hr)return Ye;hr=1;var u=B(),e=D(),i=un(),o=jr(),r=z(),c=Ar(),s=function(){};return Ye=function(f,l){var n={};l.forEach(function(a){a.facadeTransport&&(n[a.facadeTransport.transportName]=a.facadeTransport)}),n[o.transportName]=o;var t;f.bootstrap_iframe=function(){var a;r.currentWindowId=c.hash.slice(1);var h=function(b){if(b.source===parent&&(typeof t>"u"&&(t=b.origin),b.origin===t)){var C;try{C=JSON.parse(b.data)}catch{s("bad json",b.data);return}if(C.windowId===r.currentWindowId)switch(C.type){case"s":var O;try{O=JSON.parse(C.data)}catch{s("bad json",C.data);break}var T=O[0],q=O[1],v=O[2],g=O[3];if(T!==f.version)throw new Error('Incompatible SockJS! Main site uses: "'+T+'", the iframe: "'+f.version+'".');if(!u.isOriginEqual(v,c.href)||!u.isOriginEqual(g,c.href))throw new Error("Can't connect to different domain from within an iframe. ("+c.href+", "+v+", "+g+")");a=new i(new n[q](v,g));break;case"m":a._send(C.data);break;case"c":a&&a._close(),a=null;break}}};e.attachEvent("message",h),r.postMessage("s")}},Ye}var et,dr;function ln(){if(dr)return et;dr=1,Zr();var u=xr(),e=A(),i=F(),o=Yr(),r=B(),c=D(),s=en(),f=st(),l=V(),n=tn(),t=at(),a=Ir(),h=Ar(),b=rn(),C=nn(),O=an(),T=function(){},q;function v(d,m,x){if(!(this instanceof v))return new v(d,m,x);if(arguments.length<1)throw new TypeError("Failed to construct 'SockJS: 1 argument required, but only 0 present");a.call(this),this.readyState=v.CONNECTING,this.extensions="",this.protocol="",x=x||{},x.protocols_whitelist&&n.warn("'protocols_whitelist' is DEPRECATED. Use 'transports' instead."),this._transportsWhitelist=x.transports,this._transportOptions=x.transportOptions||{},this._timeout=x.timeout||0;var y=x.sessionId||8;if(typeof y=="function")this._generateSessionId=y;else if(typeof y=="number")this._generateSessionId=function(){return i.string(y)};else throw new TypeError("If sessionId is used in the options, it needs to be a number or a function.");this._server=x.server||i.numberString(1e3);var p=new u(d);if(!p.host||!p.protocol)throw new SyntaxError("The URL '"+d+"' is invalid");if(p.hash)throw new SyntaxError("The URL must not contain a fragment");if(p.protocol!=="http:"&&p.protocol!=="https:")throw new SyntaxError("The URL's scheme must be either 'http:' or 'https:'. '"+p.protocol+"' is not allowed.");var w=p.protocol==="https:";if(h.protocol==="https:"&&!w&&!r.isLoopbackAddr(p.hostname))throw new Error("SecurityError: An insecure SockJS connection may not be initiated from a page loaded over HTTPS");m?Array.isArray(m)||(m=[m]):m=[];var I=m.sort();I.forEach(function(j,E){if(!j)throw new SyntaxError("The protocols entry '"+j+"' is invalid.");if(E<I.length-1&&j===I[E+1])throw new SyntaxError("The protocols entry '"+j+"' is duplicated.")});var N=r.getOrigin(h.href);this._origin=N?N.toLowerCase():null,p.set("pathname",p.pathname.replace(/\/+$/,"")),this.url=p.href,T("using url",this.url),this._urlInfo={nullOrigin:!l.hasDomain(),sameOrigin:r.isOriginEqual(this.url,h.href),sameScheme:r.isSchemeEqual(this.url,h.href)},this._ir=new O(this.url,this._urlInfo),this._ir.once("finish",this._receiveInfo.bind(this))}e(v,a);function g(d){return d===1e3||d>=3e3&&d<=4999}return v.prototype.close=function(d,m){if(d&&!g(d))throw new Error("InvalidAccessError: Invalid code");if(m&&m.length>123)throw new SyntaxError("reason argument has an invalid length");if(!(this.readyState===v.CLOSING||this.readyState===v.CLOSED)){var x=!0;this._close(d||1e3,m||"Normal closure",x)}},v.prototype.send=function(d){if(typeof d!="string"&&(d=""+d),this.readyState===v.CONNECTING)throw new Error("InvalidStateError: The connection has not been established yet");this.readyState===v.OPEN&&this._transport.send(o.quote(d))},v.version=Cr(),v.CONNECTING=0,v.OPEN=1,v.CLOSING=2,v.CLOSED=3,v.prototype._receiveInfo=function(d,m){if(this._ir=null,!d){this._close(1002,"Cannot connect to server");return}this._rto=this.countRTO(m),this._transUrl=d.base_url?d.base_url:this.url,d=f.extend(d,this._urlInfo);var x=q.filterToEnabled(this._transportsWhitelist,d);this._transports=x.main,T(this._transports.length+" enabled transports"),this._connect()},v.prototype._connect=function(){for(var d=this._transports.shift();d;d=this._transports.shift()){if(T("attempt",d.transportName),d.needBody&&(!_.document.body||typeof _.document.readyState<"u"&&_.document.readyState!=="complete"&&_.document.readyState!=="interactive")){this._transports.unshift(d),c.attachEvent("load",this._connect.bind(this));return}var m=Math.max(this._timeout,this._rto*d.roundTrips||5e3);this._transportTimeoutId=setTimeout(this._transportTimeout.bind(this),m);var x=r.addPath(this._transUrl,"/"+this._server+"/"+this._generateSessionId()),y=this._transportOptions[d.transportName],p=new d(x,this._transUrl,y);p.on("message",this._transportMessage.bind(this)),p.once("close",this._transportClose.bind(this)),p.transportName=d.transportName,this._transport=p;return}this._close(2e3,"All transports failed",!1)},v.prototype._transportTimeout=function(){this.readyState===v.CONNECTING&&(this._transport&&this._transport.close(),this._transportClose(2007,"Transport timed out"))},v.prototype._transportMessage=function(d){var m=this,x=d.slice(0,1),y=d.slice(1),p;switch(x){case"o":this._open();return;case"h":this.dispatchEvent(new t("heartbeat")),T("heartbeat",this.transport);return}if(y)try{p=JSON.parse(y)}catch{}if(!(typeof p>"u"))switch(x){case"a":Array.isArray(p)&&p.forEach(function(w){T("message",m.transport),m.dispatchEvent(new C(w))});break;case"m":T("message",this.transport),this.dispatchEvent(new C(p));break;case"c":Array.isArray(p)&&p.length===2&&this._close(p[0],p[1],!0);break}},v.prototype._transportClose=function(d,m){if(T("_transportClose",this.transport),this._transport&&(this._transport.removeAllListeners(),this._transport=null,this.transport=null),!g(d)&&d!==2e3&&this.readyState===v.CONNECTING){this._connect();return}this._close(d,m)},v.prototype._open=function(){T("_open",this._transport&&this._transport.transportName,this.readyState),this.readyState===v.CONNECTING?(this._transportTimeoutId&&(clearTimeout(this._transportTimeoutId),this._transportTimeoutId=null),this.readyState=v.OPEN,this.transport=this._transport.transportName,this.dispatchEvent(new t("open")),T("connected",this.transport)):this._close(1006,"Server lost session")},v.prototype._close=function(d,m,x){T("_close",this.transport,d,m,x,this.readyState);var y=!1;if(this._ir&&(y=!0,this._ir.close(),this._ir=null),this._transport&&(this._transport.close(),this._transport=null,this.transport=null),this.readyState===v.CLOSED)throw new Error("InvalidStateError: SockJS has already been closed");this.readyState=v.CLOSING,setTimeout((function(){this.readyState=v.CLOSED,y&&this.dispatchEvent(new t("error"));var p=new b("close");p.wasClean=x||!1,p.code=d||1e3,p.reason=m,this.dispatchEvent(p),this.onmessage=this.onclose=this.onerror=null}).bind(this),0)},v.prototype.countRTO=function(d){return d>100?4*d:300+d},et=function(d){return q=s(d),cn()(v,d),v},et}var tt,pr;function fn(){if(pr)return tt;pr=1;var u=Kr();return tt=ln()(u),"_sockjs_onload"in _&&setTimeout(_._sockjs_onload,1),tt}var hn=fn();const vr=Sr(hn);var H={exports:{}},ee={},mr;function Lr(){return mr||(mr=1,(function(u){(function(){var e,i,o,r,c={}.hasOwnProperty,s=[].slice;e={LF:`
`,NULL:"\0"},o=(function(){var f;function l(n,t,a){this.command=n,this.headers=t??{},this.body=a??""}return l.prototype.toString=function(){var n,t,a,h,b;n=[this.command],a=this.headers["content-length"]===!1,a&&delete this.headers["content-length"],b=this.headers;for(t in b)c.call(b,t)&&(h=b[t],n.push(""+t+":"+h));return this.body&&!a&&n.push("content-length:"+l.sizeOfUTF8(this.body)),n.push(e.LF+this.body),n.join(e.LF)},l.sizeOfUTF8=function(n){return n?encodeURI(n).match(/%..|./g).length:0},f=function(n){var t,a,h,b,C,O,T,q,v,g,d,m,x,y,p,w,I;for(b=n.search(RegExp(""+e.LF+e.LF)),C=n.substring(0,b).split(e.LF),h=C.shift(),O={},m=function(N){return N.replace(/^\s+|\s+$/g,"")},w=C.reverse(),x=0,p=w.length;x<p;x++)g=w[x],q=g.indexOf(":"),O[m(g.substring(0,q))]=m(g.substring(q+1));if(t="",d=b+2,O["content-length"])v=parseInt(O["content-length"]),t=(""+n).substring(d,d+v);else for(a=null,T=y=d,I=n.length;(d<=I?y<I:y>I)&&(a=n.charAt(T),a!==e.NULL);T=d<=I?++y:--y)t+=a;return new l(h,O,t)},l.unmarshall=function(n){var t;return(function(){var a,h,b,C;for(b=n.split(RegExp(""+e.NULL+e.LF+"*")),C=[],a=0,h=b.length;a<h;a++)t=b[a],t?.length>0&&C.push(f(t));return C})()},l.marshall=function(n,t,a){var h;return h=new l(n,t,a),h.toString()+e.NULL},l})(),i=(function(){var f;function l(n){this.ws=n,this.ws.binaryType="arraybuffer",this.counter=0,this.connected=!1,this.heartbeat={outgoing:1e4,incoming:1e4},this.maxWebSocketFrameSize=16*1024,this.subscriptions={}}return l.prototype.debug=function(n){var t;return typeof window<"u"&&window!==null&&(t=window.console)!=null?t.log(n):void 0},f=function(){return Date.now?Date.now():new Date().valueOf},l.prototype._transmit=function(n,t,a){var h;for(h=o.marshall(n,t,a),typeof this.debug=="function"&&this.debug(">>> "+h);;)if(h.length>this.maxWebSocketFrameSize)this.ws.send(h.substring(0,this.maxWebSocketFrameSize)),h=h.substring(this.maxWebSocketFrameSize),typeof this.debug=="function"&&this.debug("remaining = "+h.length);else return this.ws.send(h)},l.prototype._setupHeartbeat=function(n){var t,a,h,b,C,O;if(!((C=n.version)!==r.VERSIONS.V1_1&&C!==r.VERSIONS.V1_2)&&(O=(function(){var T,q,v,g;for(v=n["heart-beat"].split(","),g=[],T=0,q=v.length;T<q;T++)b=v[T],g.push(parseInt(b));return g})(),a=O[0],t=O[1],this.heartbeat.outgoing===0||t===0||(h=Math.max(this.heartbeat.outgoing,t),typeof this.debug=="function"&&this.debug("send PING every "+h+"ms"),this.pinger=r.setInterval(h,(function(T){return function(){return T.ws.send(e.LF),typeof T.debug=="function"?T.debug(">>> PING"):void 0}})(this))),!(this.heartbeat.incoming===0||a===0)))return h=Math.max(this.heartbeat.incoming,a),typeof this.debug=="function"&&this.debug("check PONG every "+h+"ms"),this.ponger=r.setInterval(h,(function(T){return function(){var q;if(q=f()-T.serverActivity,q>h*2)return typeof T.debug=="function"&&T.debug("did not receive server activity for the last "+q+"ms"),T.ws.close()}})(this))},l.prototype._parseConnect=function(){var n,t,a,h;switch(n=1<=arguments.length?s.call(arguments,0):[],h={},n.length){case 2:h=n[0],t=n[1];break;case 3:n[1]instanceof Function?(h=n[0],t=n[1],a=n[2]):(h.login=n[0],h.passcode=n[1],t=n[2]);break;case 4:h.login=n[0],h.passcode=n[1],t=n[2],a=n[3];break;default:h.login=n[0],h.passcode=n[1],t=n[2],a=n[3],h.host=n[4]}return[h,t,a]},l.prototype.connect=function(){var n,t,a,h;return n=1<=arguments.length?s.call(arguments,0):[],h=this._parseConnect.apply(this,n),a=h[0],this.connectCallback=h[1],t=h[2],typeof this.debug=="function"&&this.debug("Opening Web Socket..."),this.ws.onmessage=(function(b){return function(C){var O,T,q,v,g,d,m,x,y,p,w,I;if(v=typeof ArrayBuffer<"u"&&C.data instanceof ArrayBuffer?(O=new Uint8Array(C.data),typeof b.debug=="function"&&b.debug("--- got data length: "+O.length),(function(){var N,j,E;for(E=[],N=0,j=O.length;N<j;N++)T=O[N],E.push(String.fromCharCode(T));return E})().join("")):C.data,b.serverActivity=f(),v===e.LF){typeof b.debug=="function"&&b.debug("<<< PONG");return}for(typeof b.debug=="function"&&b.debug("<<< "+v),w=o.unmarshall(v),I=[],y=0,p=w.length;y<p;y++)switch(g=w[y],g.command){case"CONNECTED":typeof b.debug=="function"&&b.debug("connected to server "+g.headers.server),b.connected=!0,b._setupHeartbeat(g.headers),I.push(typeof b.connectCallback=="function"?b.connectCallback(g):void 0);break;case"MESSAGE":x=g.headers.subscription,m=b.subscriptions[x]||b.onreceive,m?(q=b,d=g.headers["message-id"],g.ack=function(N){return N==null&&(N={}),q.ack(d,x,N)},g.nack=function(N){return N==null&&(N={}),q.nack(d,x,N)},I.push(m(g))):I.push(typeof b.debug=="function"?b.debug("Unhandled received MESSAGE: "+g):void 0);break;case"RECEIPT":I.push(typeof b.onreceipt=="function"?b.onreceipt(g):void 0);break;case"ERROR":I.push(typeof t=="function"?t(g):void 0);break;default:I.push(typeof b.debug=="function"?b.debug("Unhandled frame: "+g):void 0)}return I}})(this),this.ws.onclose=(function(b){return function(){var C;return C="Whoops! Lost connection to "+b.ws.url,typeof b.debug=="function"&&b.debug(C),b._cleanUp(),typeof t=="function"?t(C):void 0}})(this),this.ws.onopen=(function(b){return function(){return typeof b.debug=="function"&&b.debug("Web Socket Opened..."),a["accept-version"]=r.VERSIONS.supportedVersions(),a["heart-beat"]=[b.heartbeat.outgoing,b.heartbeat.incoming].join(","),b._transmit("CONNECT",a)}})(this)},l.prototype.disconnect=function(n,t){return t==null&&(t={}),this._transmit("DISCONNECT",t),this.ws.onclose=null,this.ws.close(),this._cleanUp(),typeof n=="function"?n():void 0},l.prototype._cleanUp=function(){if(this.connected=!1,this.pinger&&r.clearInterval(this.pinger),this.ponger)return r.clearInterval(this.ponger)},l.prototype.send=function(n,t,a){return t==null&&(t={}),a==null&&(a=""),t.destination=n,this._transmit("SEND",t,a)},l.prototype.subscribe=function(n,t,a){var h;return a==null&&(a={}),a.id||(a.id="sub-"+this.counter++),a.destination=n,this.subscriptions[a.id]=t,this._transmit("SUBSCRIBE",a),h=this,{id:a.id,unsubscribe:function(){return h.unsubscribe(a.id)}}},l.prototype.unsubscribe=function(n){return delete this.subscriptions[n],this._transmit("UNSUBSCRIBE",{id:n})},l.prototype.begin=function(n){var t,a;return a=n||"tx-"+this.counter++,this._transmit("BEGIN",{transaction:a}),t=this,{id:a,commit:function(){return t.commit(a)},abort:function(){return t.abort(a)}}},l.prototype.commit=function(n){return this._transmit("COMMIT",{transaction:n})},l.prototype.abort=function(n){return this._transmit("ABORT",{transaction:n})},l.prototype.ack=function(n,t,a){return a==null&&(a={}),a["message-id"]=n,a.subscription=t,this._transmit("ACK",a)},l.prototype.nack=function(n,t,a){return a==null&&(a={}),a["message-id"]=n,a.subscription=t,this._transmit("NACK",a)},l})(),r={VERSIONS:{V1_0:"1.0",V1_1:"1.1",V1_2:"1.2",supportedVersions:function(){return"1.1,1.0"}},client:function(f,l){var n,t;return l==null&&(l=["v10.stomp","v11.stomp"]),n=r.WebSocketClass||WebSocket,t=new n(f,l),new i(t)},over:function(f){return new i(f)},Frame:o},u!==null&&(u.Stomp=r),typeof window<"u"&&window!==null?(r.setInterval=function(f,l){return window.setInterval(l,f)},r.clearInterval=function(f){return window.clearInterval(f)},window.Stomp=r):u||(self.Stomp=r)}).call(ee)})(ee)),ee}var J={};const dn={},pn=Object.freeze(Object.defineProperty({__proto__:null,default:dn},Symbol.toStringTag,{value:"Module"})),vn=Pr(pn);var rt,gr;function mn(){if(gr)return rt;gr=1;var u=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};return rt=(function(){if(this)return this;if(typeof globalThis=="object"&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return u()}try{return __global__||u()}finally{delete Object.prototype.__global__}})(),rt}const gn="1.0.35",bn={version:gn};var nt,br;function yn(){return br||(br=1,nt=bn.version),nt}var it,yr;function wn(){if(yr)return it;yr=1;var u;if(typeof globalThis=="object")u=globalThis;else try{u=mn()}catch{}finally{if(!u&&typeof window<"u"&&(u=window),!u)throw new Error("Could not determine global this")}var e=u.WebSocket||u.MozWebSocket,i=yn();function o(r,c){var s;return c?s=new e(r,c):s=new e(r),s}return e&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(r){Object.defineProperty(o,r,{get:function(){return e[r]}})}),it={w3cwebsocket:e?o:null,version:i},it}var wr;function _n(){return wr||(wr=1,(function(){var u,e,i,o,r,c;u=Lr(),e=vn,u.Stomp.setInterval=function(s,f){return setInterval(f,s)},u.Stomp.clearInterval=function(s){return clearInterval(s)},r=function(s,f){var l,n;return l=null,n={url:"tcp:// "+f+":"+s,send:function(t){return l.write(t)},close:function(){return l.end()}},l=e.connect(s,f,function(t){return n.onopen()}),l.on("error",function(t){return typeof n.onclose=="function"?n.onclose(t):void 0}),l.on("close",function(t){return typeof n.onclose=="function"?n.onclose(t):void 0}),l.on("data",function(t){var a;return a={data:t.toString()},n.onmessage(a)}),n},c=function(s){var f,l,n,t;return f=wn().client,l=null,t={url:s,send:function(a){return l.sendUTF(a)},close:function(){return l.close()}},n=new f,n.on("connect",function(a){return l=a,t.onopen(),l.on("error",function(h){return typeof t.onclose=="function"?t.onclose(h):void 0}),l.on("close",function(){return typeof t.onclose=="function"?t.onclose():void 0}),l.on("message",function(h){var b;if(h.type==="utf8")return b={data:h.utf8Data},t.onmessage(b)})}),n.connect(s),t},i=function(s,f){var l;return l=r(f,s),u.Stomp.over(l)},o=function(s){var f;return f=c(s),u.Stomp.over(f)},J.overTCP=i,J.overWS=o}).call(J)),J}var _r;function En(){if(_r)return H.exports;_r=1;var u=Lr(),e=_n();return H.exports=u.Stomp,H.exports.overTCP=e.overTCP,H.exports.overWS=e.overWS,H.exports}var Sn=En();const Er=Sr(Sn);L(()=>{const u=L("body").data("member-id")?.toString(),e={NAV_CACHE:`artist_nav_cache_${u}`,NOTIFICATION:`noti_${u}`},i={NAV_CONNECTED:"/api/v1/artists/connected",NOTI_UNREAD:"/api/v1/notifications/unread",NOTI_READ:"/api/v1/notifications/"},o={NAV_MIN_LOADING_TIME:500,NOTI_CACHE_EXPIRATION:1800*1e3,SKELETON_COUNT:5},r=L(".side-nav"),c=L("main"),s=L("#menu-toggle"),f=L("#header-nav"),l=s.find("i"),n=L("#user-menu-toggle"),t=L("#user-dropdown"),a=L("#notification-badge"),h=L("#notification-list");function b(){r.length>0?(L(document).on("artist:nav-update",C),O()):c.css("justify-content","center")}function C(){sessionStorage.removeItem(e.NAV_CACHE),O()}function O(){const S=sessionStorage.getItem(e.NAV_CACHE);if(S)try{g(JSON.parse(S));return}catch{sessionStorage.removeItem(e.NAV_CACHE)}v();const R=Date.now();L.ajax({url:i.NAV_CONNECTED,type:"GET",success:k=>T(k,R),error:()=>q(R)})}function T(S,R){const k=Math.max(0,o.NAV_MIN_LOADING_TIME-(Date.now()-R));setTimeout(()=>{S.success&&(sessionStorage.setItem(e.NAV_CACHE,JSON.stringify(S.data)),g(S.data))},k)}function q(S){const R=Math.max(0,o.NAV_MIN_LOADING_TIME-(Date.now()-S));setTimeout(()=>g({subscriptions:[],follows:[]}),R)}function v(){let S='<div class="side-nav__section">';for(let R=0;R<o.SKELETON_COUNT;R++)S+='<div class="side-nav__skeleton"></div>';S+="</div>",r.html(S)}function g(S){let R="";const k=new Set(S.subscriptions.map(M=>M.id)),U=S.follows.filter(M=>!k.has(M.id)),$=S.subscriptions.length>0,X=U.length>0;$&&(R+='<div class="side-nav__section">',S.subscriptions.forEach(M=>R+=d(M)),R+="</div>"),$&&X&&(R+='<div class="side-nav__divider"></div>'),X&&(R+='<div class="side-nav__section">',U.forEach(M=>R+=d(M)),R+="</div>"),($||X)&&(R+='<div class="side-nav__divider"></div>'),R+=`
            <div class="side-nav__section">
                <a href="/artist/list" class="artist-icon artist-icon--empty" data-name=" " data-blog="  !">
                    <i class="fa-solid fa-plus"></i>
                </a>
            </div>
        `,r.html(R).hide().fadeIn(300)}function d(S){return`
            <a href="/artist/${S.id}" class="artist-icon" data-name="${S.nickname}" data-blog="${S.blogName}">
                <img src="${S.profilePath}" alt="${S.nickname}">
            </a>
        `}const m=L('<div id="global-tooltip"></div>').appendTo("body");L(document).on("mouseenter",".artist-icon",S=>{const R=S.currentTarget,k=L(R),U=k.data("name"),$=k.data("blog");m.html(`
        <div class="tooltip-blog">${$||U+"'s World"}</div>
        <div class="tooltip-name">${U}</div>
    `);const X=R.getBoundingClientRect();m.css({top:X.top+X.height/2-(m.outerHeight()||0)/2+"px",left:X.right+12+"px",opacity:1,visibility:"visible"})}),L(document).on("mouseleave",".artist-icon",()=>m.css({opacity:0,visibility:"hidden"})),s.length&&s.on("click",()=>{f.toggleClass("header__nav--open"),l.toggleClass("fa-bars fa-times")}),n.length&&t.length&&(n.on("click",S=>{S.stopPropagation(),t.toggleClass("header__user-dropdown--active")}),L(document).on("click",S=>{!t.is(S.target)&&t.has(S.target).length===0&&!n.is(S.target)&&n.has(S.target).length===0&&t.removeClass("header__user-dropdown--active")}));function x(){u&&(y(),I(u))}function y(){const S=localStorage.getItem(e.NOTIFICATION);if(S)try{const R=JSON.parse(S);Date.now()-R.timestamp>o.NOTI_CACHE_EXPIRATION?p():w(R.list)}catch{p()}else p()}function p(){L.ajax({url:i.NOTI_UNREAD,type:"GET",success:S=>{j(S||[]),w(S||[])}})}function w(S){if(S&&S.length>0){a.text(S.length).show();let R="";S.forEach(k=>R+=E(k)),h.html(R)}else a.hide(),h.html('<li class="empty-message">  .</li>')}function I(S){if(typeof vr>"u"||typeof Er>"u")return;const R=Er.over(new vr("/ws-stomp"));R.debug=()=>{},R.connect({},()=>{R.subscribe("/sub/notification/"+S,k=>{N(JSON.parse(k.body))})})}function N(S){let R=[];try{const k=localStorage.getItem(e.NOTIFICATION);k&&(R=JSON.parse(k).list||[])}catch{}R.unshift(S),j(R),w(R)}function j(S){localStorage.setItem(e.NOTIFICATION,JSON.stringify({timestamp:Date.now(),list:S}))}function E(S){return`
            <li class="notification-item unread" data-id="${S.id}" onclick="handleNotificationClick('${S.notiUrl}', '${S.id}')">
                <div class="notification-message">${S.notiMessage}</div>
                <div class="notification-time"> </div>
            </li>
        `}window.handleNotificationClick=function(S,R){try{const k=localStorage.getItem(e.NOTIFICATION);if(k){const U=JSON.parse(k);U.list=U.list.filter($=>$.id.toString()!==R),localStorage.setItem(e.NOTIFICATION,JSON.stringify(U))}}catch{}fetch(i.NOTI_READ+R+"/read",{method:"PATCH",keepalive:!0,headers:{"Content-Type":"application/json"}}),location.href=S},b(),x()});
