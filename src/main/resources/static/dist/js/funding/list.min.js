import{j as e}from"../util/alert.min.js";e(()=>{const l=e("#funding-list-grid"),d=e("#funding-status-message"),g=a=>{d.html(`<i class="fas fa-exclamation-circle"></i><br>${a}`).show()},m=a=>{if(!a||a.length===0){d.html('<i class="fas fa-search"></i><br>조건에 맞는 펀딩 프로젝트가 없습니다.').show();return}d.hide();let t="";a.forEach(s=>{let i="",c="",r="funding-card";switch(s.status){case"PROCEEDING":i="badge-proceeding",c=s.daysLeft>0?`D-${s.daysLeft}`:s.daysLeft===0?"오늘 마감":"마감 임박";break;case"WAITING":case"UPCOMING":i="badge-upcoming",c="오픈 예정";break;case"SUCCESS":i="badge-success",c="펀딩 성공",r+=" ended";break;case"ENDED":case"FAILED":case"REJECTED":case"CANCELLED":i="badge-ended",c="종료됨",r+=" ended";break;default:i="badge-ended",c=s.status}const u=s.collectedAmount?s.collectedAmount.toLocaleString():"0",h=s.thumbnailPath||"/images/no-image.png",b=s.achieveRate>100?100:s.achieveRate;t+=`
                <a href="/artist/${s.artistId}/funding/${s.id}" class="${r}">
                    <div class="card-thumb-box">
                        <span class="card-badge ${i}">${c}</span>
                        <img src="${h}" alt="${s.title}" class="card-thumb" loading="lazy">
                    </div>
                    <div class="card-body">
                        <div class="card-artist">
                            <i class="fas fa-user-circle"></i> ${s.artistName}
                        </div>
                        <h3 class="card-title">${s.title}</h3>
                        
                        <div class="card-metrics">
                            <div class="metric-row">
                                <span class="metric-rate">${s.achieveRate}%</span>
                                <span class="metric-amount">${u}원</span>
                            </div>
                            <div class="progress-container">
                                <div class="progress-fill" style="width: ${b}%"></div>
                            </div>
                        </div>
                    </div>
                </a>
            `}),l.html(t)},n=a=>{l.empty(),d.html('<div class="spinner"><i class="fas fa-circle-notch fa-spin"></i></div>').show(),e.ajax({url:"/api/v1/crowd-funding/list",type:"GET",data:{status:a},success:t=>{const s=t.data||[];m(s)},error:()=>{g("서버 통신 중 오류가 발생했습니다.")}})};e(".tab-btn").on("click",a=>{const t=e(a.currentTarget);if(t.hasClass("active"))return;e(".tab-btn").removeClass("active"),t.addClass("active");const s=t.data("status");n(s)});const o="PROCEEDING";e(`.tab-btn[data-status="${o}"]`).addClass("active").siblings().removeClass("active"),n(o)});
