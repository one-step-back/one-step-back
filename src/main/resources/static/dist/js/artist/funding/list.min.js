import{j as c}from"../../util/alert.min.js";c(()=>{const r=c("#funding-grid");let e=c(".funding-container").data("artist-id");if(!e){const s=window.location.pathname.split("/"),a=s.indexOf("artist");a>-1&&s.length>a+1&&(e=s[a+1])}if(!e||e==="undefined"){console.error("Artist ID not found!"),r.html('<p style="text-align:center; padding: 40px;">아티스트 정보를 찾을 수 없습니다.</p>');return}const p=s=>Array.isArray(s)?new Date(s[0],s[1]-1,s[2],s[3]||0,s[4]||0,s[5]||0):new Date(s),l=s=>(s||0).toLocaleString()+"원",g=s=>{switch(s){case"UPCOMING":return"오픈 예정";case"WAITING":return"승인 대기";case"PROCEEDING":return"진행 중";case"SUCCESS":return"펀딩 성공";case"FAILED":return"펀딩 실패";case"ENDED":return"종료됨";case"REJECTED":return"반려됨";case"CANCELLED":return"취소됨";case"COMPLETED":return"완료됨";default:return s}},h=()=>{c.ajax({url:`/api/v1/crowd-funding/list?artistId=${e}`,type:"GET",success:s=>{const a=s.data||[];y(a)},error:s=>{console.error("펀딩 목록 로드 실패",s),r.html('<p style="text-align:center; padding: 40px;">데이터를 불러오지 못했습니다.</p>')}})},y=s=>{let a="";if(!s||s.length===0){a=`
                <div class="empty-funding">
                    <i class="fas fa-hand-holding-heart"></i>
                    <p>진행 중인 펀딩이 없습니다.</p>
                </div>
            `,r.html(a);return}s.forEach(t=>{const d=new Date,o=p(t.startDate);let i=t.status,f=!1;t.status==="PROCEEDING"&&o.getTime()>d.getTime()&&(i="UPCOMING",f=!0);const v=g(i),u=t.achieveRate!==void 0?t.achieveRate:Math.floor(t.currentAmount/t.targetAmount*100);let n;if(f){const E=o.getTime()-d.getTime();n=`<span class="days-left" style="color:#7c3aed; font-weight:700;">D-${Math.ceil(E/(1e3*60*60*24))} (오픈)</span>`}else i==="PROCEEDING"?t.daysLeft!==void 0?n=`<span class="days-left" style="color:#2563eb; font-weight:700;">${t.daysLeft}일 남음</span>`:n='<span class="days-left">진행 중</span>':i==="WAITING"?n='<span class="days-left" style="color:#f59e0b;">승인 대기</span>':n='<span class="days-left" style="color:#64748b;">종료됨</span>';a+=`
                <a href="/artist/${e}/funding/${t.id}" class="funding-card">
                    <div class="card-thumb">
                        <img src="${t.mainImgPath}" alt="${t.title}">
                        <span class="status-label status-${t.status}">${v}</span>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">${t.title}</h3>
                        <div class="card-meta">
                            목표 ${l(t.targetAmount)}
                        </div>
                        <div class="card-progress-area">
                            <div class="progress-info">
                                <span class="percent">${u}%</span>
                                <span class="amount">${l(t.currentAmount)}</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${Math.min(u,100)}%"></div>
                            </div>
                            <div class="card-days">
                                ${n}
                            </div>
                        </div>
                    </div>
                </a>
            `}),r.html(a)};h()});
