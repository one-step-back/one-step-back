import{j as e}from"../../util/alert.min.js";import{S as b}from"../../util/toast.min.js";e(()=>{let a=null,l=!0,c=!1;const i=s=>(s||0).toLocaleString()+"원",u=s=>{switch(s){case"REQUESTED":return"지급 대기";case"COMPLETED":return"지급 완료";case"REJECTED":return"반려됨";default:return s}},h=()=>{const s=e("#btn-load-more");l?s.html('더보기 <i class="fas fa-chevron-down"></i>').show():s.hide()},f=s=>{const n=e("#history-list-body");let o="";s.forEach(t=>{const r=u(t.status),p="status-"+t.status,m=t.requestTime?t.requestTime.split("T")[0]:"-",y=t.completeTime?t.completeTime.split("T")[0]:"-";o+=`
                <tr>
                    <td>${m}</td>
                    <td>${i(t.totalAmount)}</td>
                    <td class="text-danger">-${i(t.feeAmount)}</td>
                    <td style="font-weight:700;">${i(t.netAmount)}</td>
                    <td><span class="status-badge ${p}">${r}</span></td>
                    <td>${y}</td>
                </tr>
            `}),n.append(o)},d=()=>{if(!l||c)return;c=!0,e("#btn-load-more").html('<i class="fas fa-spinner fa-spin"></i> 불러오는 중...');let n="/api/v1/settlements/history";a!==null&&(n+=`?lastId=${a}`),e.ajax({url:n,type:"GET",success:o=>{const t=o.data||o,r=t.content||[];l=t.hasNext,r.length>0?(f(r),a=r[r.length-1].id,e("#history-empty").hide()):a===null&&e("#history-empty").show(),h()},error:o=>{console.error("내역 로드 실패",o),b.error("정산 내역을 불러오지 못했습니다.")},complete:()=>{c=!1}})};e("#btn-load-more").on("click",()=>{d()}),d()});
