import{j as r}from"../util/alert.min.js";import{S as o}from"../util/toast.min.js";r(()=>{const p=r("#artistForm"),c=r("#blogImage"),a=r("#banner-preview"),m=a.find(".upload-icon-wrapper"),f=r("#blogName"),u=r("#description"),l=r("#btn-submit");a.on("click",()=>{c.trigger("click")}),c.on("change",t=>{const s=t.target.files?.[0];if(s){const e=new FileReader;e.onload=n=>{m.hide(),a.find(".preview-img").remove();const g=`<img src="${n.target?.result}" class="preview-img" alt="Banner Preview">`;a.append(g),a.addClass("has-image")},e.readAsDataURL(s)}else a.find(".preview-img").remove(),m.show(),a.removeClass("has-image")}),p.on("submit",function(t){if(t.preventDefault(),v(),!h())return;const i=new FormData(this),s=l.text();l.prop("disabled",!0).html('<i class="fas fa-spinner fa-spin"></i> 개설 중...'),r.ajax({url:"/api/v1/artists/register",type:"POST",data:i,processData:!1,contentType:!1,success:e=>{if(e.success&&e.data){const n=e.data;window.location.href=`/artist/${n}`}else e.error&&(w(e.error),l.prop("disabled",!1).text(s))},error:e=>{console.error("Artist Register Error:",e),o.error("채널 생성 중 오류가 발생했습니다."),l.prop("disabled",!1).text(s)}})});function v(){r(".field-error-border").removeClass("field-error-border"),r(".validation-msg").text("").removeClass("field-error")}function h(){const t=f.val().trim(),i=u.val().trim();return c[0].files?.[0]?t?t.length<2||t.length>20?(o.error("채널 이름은 2~20자 사이여야 합니다."),f.trigger("focus"),!1):i?!0:(o.error("소개글을 입력해주세요."),u.trigger("focus"),!1):(o.error("채널 이름을 입력해주세요."),f.trigger("focus"),!1):(o.error("채널을 대표할 배너 이미지를 등록해주세요."),!1)}function w(t){if(t.code==="VAL-001"){const i=/\[(.*?): (.*?)]/g;let s;for(;(s=i.exec(t.message))!==null;){const e=s[1],n=s[2],d=r("#"+e),g=r("#"+e+"-msg");d.length&&(d.addClass("field-error-border"),g.text(n).addClass("field-error"))}}else o.error(t.message)}});
